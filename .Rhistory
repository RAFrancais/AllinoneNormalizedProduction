ggplot(subset(statscombined_Zgames), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season", subtitle = "Players with over 10 games played") + coord_flip() + xlab("Player")
ggplot(subset(statscombined_Zgames), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season", subtitle = "Players with over 20 games played") + coord_flip() + xlab("Player")
ggplot(statscombined_Z, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab("Player")
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Mileage", labels=c("Point Guard", "Shooting Guard", "Small Forward", "Power Forward", "Center"), values=c("PG"="#FF2E00", "SG"="#0078FF", "SF"="#000000", "PF"="#008000","C"="#808000")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab(Player)
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Mileage", labels=c("Point Guard", "Shooting Guard", "Small Forward", "Power Forward", "Center"), values=c("PG"="#FF2E00", "SG"="#0078FF", "SF"="#000000", "PF"="#008000","C"="#808000")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab('Player')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Mileage", labels=c("Point Guard", "Shooting Guard", "Small Forward", "Power Forward", "Center"), values=c("PG"="#FF2E00", "SG"="#0078FF", "SF"="#000000", "PF"="#008000","C"="#808000")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab('Player')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF2E00", "SG"="#0078FF", "SF"="#000000", "PF"="#008000","C"="#808000")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab('Player')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="##FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab('Player')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab('Player')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
setwd("D:/RLearning/All-in-one")
install.packages("XML")
install.packages("RCurl")
install.packages("plyr")
install.packages("ggplot2")
library(XML)
library(RCurl)
library(plyr)
library(ggplot2)
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
# These produce the same results: url <- "https://stats.nba.com/leaders/"
urldata <-  getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
#This one does not work
dat3 <- as.data.frame(data, col.names = names(data), headers = TRUE)
#This one works - But all variables are characteristic
stats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(stats18)[12] <- "FGpct"
colnames(stats18)[13] <- "3P"
colnames(stats18)[14] <- "3PA"
colnames(stats18)[15] <- "3Ppct"
colnames(stats18)[16] <- "2P"
colnames(stats18)[17] <- "2PA"
colnames(stats18)[18] <- "2Ppct"
colnames(stats18)[19] <- "eFG"
colnames(stats18)[22] <- "FTpct"
#Removing irrelevant variables, NAs, and converting to numeric
stats18$.id <- NULL
stats18$Rk <- NULL
##Numeric needs to ignore the character variables
stats18numeric <- as.data.frame(sapply(stats18[c(3,5:29)], as.numeric))
stats18numeric[is.na(stats18numeric)] <- 0
#Isolating all traded players that show up as double in the data set
TOTplayer <- subset(stats18, Tm == "TOT")
#Cleaning traded duplicates and adding in traded players totals
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
"%ni%" <- Negate("%in%")
statsnotTraded <- subset(stats18, Player %ni% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
statsbind <- rbind(statsnotTraded, TOTplayer)
#Eliminating the extraneous "player" headers from the HTML Table
statsbind2 <- subset(statsbind, Player %ni% c("Player"))
statsbind555 <- subset(statsbind, Player %ni% c("Player"))
#Calculating Z Scores
statsbind2 <- as.data.frame(sapply(statsbind2[c(3,5:29)], as.numeric))
statsbind2[is.na(statsbind2)] <- 0
statsbind2$PTSZ <- (statsbind2$PTS - mean(statsbind2$PTS))/sd(statsbind2$PTS)
statsbindScale <- scale(statsbind2[,1:27])
##Problem here is that they need identical rows so the orignal needs to be subset
statscbindScale <- cbind(statsbind555[c(1,2,4)], statsbindScale)
statscbindScale$NegTOV <- statscbindScale$TOV * -1
statscbindScale$NegPF <- statscbindScale$PF * -1
##Creating the all-in-one value
statscbindScale[,31] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,28,29,30)])
statscbindScale$combined_Z <- statscbindScale[,31]/12
##Data visualization
statscombined_Z <- subset(statscbindScale, combined_Z < -1.3 | combined_Z > 1.08)
statscbindScale$abovebelow_Z <- ifelse(statscbindScale$combined_Z < 0, "below", "above")
ggplot(statscombined_Z, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab("Player")
##Players with over 20 games played
statscombined_Zgames <- subset(statscbindScale, G > -1.095 & (combined_Z < -.5262 | combined_Z > 1.08))
ggplot(subset(statscombined_Zgames), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season", subtitle = "Players with over 20 games played") + coord_flip() + xlab("Player")
#Top 25 Players by Normalized Position
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
statscombined_Zgames$abovebelow_Z <- ifelse(statscombined_Zgames$combined_Z < 0, "below", "above")
ggplot(subset(statscombined_Zgames), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season", subtitle = "Players with over 20 games played") + coord_flip() + xlab("Player")
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
frequency(subset(statscbindScale$Pos, combined_Z > 1.02))
View(statscbindScale)
frequency(subset(statscbindScale$Pos, combined_Z > 1.02))
statsfreq25 <- subset(statscbindScale, combined_Z > 1.02)
freqtable <- freq(statsfreq25$Pos)
freqtable <- frequency(statsfreq25$Pos)
c?
?
)
?c
freqtable <- c(10/25,3/25,5/25,4/25,3/25)
str(freqtable)
is.data.frame(freqtable)
freqmatrix <- matrix(freqtable, ncol=5, byrow = TRUE)
View(freqmatrix)
transpose
t(freqmatrix)
freqmatrix <- t(freqmatrix)
as.data.frame(freqmatrix, stringsAsFactors = FALSE)
freqframe <- as.data.frame(freqmatrix, stringsAsFactors = FALSE)
View(freqmatrix)
freqframe[,2] <- c(Center, Power Forward, Point Guard, Small Forward, Shooting Guard)
freqframe[,2] <- c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard")
View(freqframe)
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar("y", start = 0)+ geom_text(aes(y=lab.ypos, label = V1), color = "white") + scale_fill+manual(values = mycols) + theme_void()
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar("y", start = 0)+ geom_text(aes(y=lab.ypos, label = V1), color = "white") + scale_fill_manual(values = mycols) + theme_void()
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar("y", start = 0)+ geom_text(aes(y=lab.ypos, label = V1), color = "white") + scale_fill_manual("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF"))) + theme_void()
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar("y", start = 0)+ geom_text(aes(y=lab.ypos, label = V1), color = "white") + scale_fill_manual(name="Position", labels=c(Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF"))) + theme_void()
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar("y", start = 0)+ geom_text(aes(y=lab.ypos, label = V1), color = "white") + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF"))) + theme_void()
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar("y", start = 0)+ geom_text(aes(y=lab.ypos, label = V1), color = "white") + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) + theme_void()
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar("y", start = 0)+ geom_text(aes(y = V1/2 + cumsum(V1)[-length(V1)]), label = percent, size = 10), color = "white") + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) + theme_void()
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar("y", start = 0)+ geom_text(aes(y = V1/2 + cumsum(V1)[-length(V1)]), label = percent), size = 10), color = "white") + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) + theme_void()
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar("y", start = 0)+ geom_text(aes(y = V1/2 + c(0, cumsum(V1)[-length(V1)]), label = percent), size = 10), color = "white") + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) + theme_void()
install.pacakges("dplyr")
install.pacakge("dplyr")
install.packages("dplyr")
fds
freqframe <- freqframe %>%
arrane(desc(V2)) %>%
mutate(lab.ypos = cumsum(V1)-0.5V1)
freqframe <- freqframe %>%
arrange(desc(V2)) %>% mutate(lab.ypos = cumsum(V1) - 0.5V1)
names(freqframe)[,1:2] <- "Prob", "Position"
names(freqframe)[,1:2] <- "Prob" "Position"
names(freqframe)[1] <- "Prob"
names(freqframe)[2] <- "Position"
View(freqframe)
freqframe <- freqframe %>%
arrange(desc(Position)) %>%
mutate(lab.ypos = cumsum(Prob)-0.5*(Prob))
library(dplyr)
freqframe <- freqframe %>%
+ arrange(desc(Position)) %>%
+ mutate(lab.ypos = cumsum(Prob)-0.5*(Prob))
freqframe <- freqframe%>% + arrange(desc(Position)) %>% + mutate(lab.ypos = cumsum(Prob) - 0.5(Prob))
View(freqframe)
str(freqframe)
count.data <- count.data %>%
arrange(desc(class)) %>%
arrange(desc(Position)) %>%
mutate(lab.ypos = cumsum(Prob) - 0.5*Prob)
freqframe <- freqframe %>%
arrange(desc(Position)) %>%
arrange(desc(class)) %>%
)
freqframe[2] <- "PlayerPosition"
freqframe <- freqframe %>%
arrange(desc(Position)) %>%
)
freqframe <- freqframe %>%
View(freqframe)
arrange(desc(Position)) %>%)
View(freqmatrix)
ggplot(freqframe, aes(x="",y=V1, fill = V2)) + geom_bar(width = 1, stat = "identity", color = "white") + coord_polar(theta = "y")+ geom_text(aes(y = V1/2 + c(0, cumsum(V1)[-length(V1)]), label = percent), size = 10), color = "white") + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) + theme_void()
freqframe <- as.data.frame(freqmatrix, stringsAsFactors = FALSE)
library(XML)
library(RCurl)
library(plyr)
library(ggplot2)
freqframe[,2] <- c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard")
names(freqframe)[1] <- "Prob"
names(freqframe)[2] <- "PlayerPosition"
piechart <- ggplot(freqframe, aes(x="", y= "Prob", fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5)) + labs(fill = "class", x = NULL, y = NULL, title = "Distribution of Positions in the Top 25") + coord_polar(theta = "y", start = 0)
View(piechart)
ggplot(freqframe, aes(x="", y= "Prob", fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5)) + labs(fill = "class", x = NULL, y = NULL, title = "Distribution of Positions in the Top 25") + coord_polar(theta = "y", start = 0)
ggplot(freqframe, aes(x="", y= "Prob", fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5)) + labs(fill = "Position", x = NULL, y = NULL, title = "Distribution of Positions in the Top 25") + coord_polar(theta = "y", start = 0)
ggplot(freqframe, aes(x="", y= Prob, fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5)) + labs(fill = "Position", x = NULL, y = NULL, title = "Distribution of Positions in the Top 25") + coord_polar(theta = "y", start = 0)
ggplot(freqframe, aes(x="", y= Prob, fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5)) + labs(fill = "Position", x = NULL, y = NULL, title = "Distribution of Positions in the Top 25") + coord_polar(theta = "y", start = 0) + geom_text(aes(label=Prob), position = position_stack(vjust = 0.5))
ggplot(freqframe, aes(x="", y= Prob, fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5)) + labs(fill = "Position", x = NULL, y = NULL, title = "Proportion of Positions in the Top 25 Players") + coord_polar(theta = "y", start = 0) + geom_text(aes(label=Prob), position = position_stack(vjust = 0.5)) + blank_theme
ggplot(freqframe, aes(x="", y= Prob, fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5)) + labs(fill = "Position", x = NULL, y = NULL, title = "Proportion of Positions in the Top 25 Players") + coord_polar(theta = "y", start = 0) + geom_text(aes(label=Prob), position = position_stack(vjust = 0.5)) + blank_theme()
ggplot(freqframe, aes(x="", y= Prob, fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5), axis.text.x = element_blank()) + labs(fill = "Position", x = NULL, y = NULL, title = "Proportion of Positions in the Top 25 Players") + coord_polar(theta = "y", start = 0) + geom_text(aes(label=Prob), position = position_stack(vjust = 0.5))
ggplot(freqframe, aes(x="", y= Prob, fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5), axis.text.x = element_blank()) + labs(fill = "Position", x = NULL, y = NULL, title = "Proportion of Positions in the Top 25 Players") + coord_polar(theta = "y", start = 0) + geom_text(aes(label=Prob), position = position_stack(vjust = 0.5))
ggplot(statscombined_Z, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab("Player")
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
# These produce the same results: url <- "https://stats.nba.com/leaders/"
urldata <-  getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
#This one does not work dat3 <- as.data.frame(data, col.names = names(data), headers = TRUE)
#This one works - But all variables are characteristic
stats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(stats18)[12] <- "FGpct"
colnames(stats18)[13] <- "3P"
colnames(stats18)[14] <- "3PA"
colnames(stats18)[15] <- "3Ppct"
colnames(stats18)[16] <- "2P"
colnames(stats18)[17] <- "2PA"
colnames(stats18)[18] <- "2Ppct"
colnames(stats18)[19] <- "eFG"
colnames(stats18)[22] <- "FTpct"
#Removing irrelevant variables, NAs, and converting to numeric
stats18$.id <- NULL
stats18$Rk <- NULL
##Numeric needs to ignore the character variables
stats18numeric <- as.data.frame(sapply(stats18[c(3,5:29)], as.numeric))
stats18numeric[is.na(stats18numeric)] <- 0
#Isolating all traded players that show up as double in the data set
TOTplayer <- subset(stats18, Tm == "TOT")
#Cleaning traded duplicates and adding in traded players totals
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
"%ni%" <- Negate("%in%")
statsnotTraded <- subset(stats18, Player %ni% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
statsbind <- rbind(statsnotTraded, TOTplayer)
#Eliminating the extraneous "player" headers from the HTML Table
statsbind2 <- subset(statsbind, Player %ni% c("Player"))
statsbind555 <- subset(statsbind, Player %ni% c("Player"))
#Calculating Z Scores
statsbind2 <- as.data.frame(sapply(statsbind2[c(3,5:29)], as.numeric))
statsbind2[is.na(statsbind2)] <- 0
statsbind2$PTSZ <- (statsbind2$PTS - mean(statsbind2$PTS))/sd(statsbind2$PTS)
statsbindScale <- scale(statsbind2[,1:27])
##Problem here is that they need identical rows so the orignal needs to be subset
statscbindScale <- cbind(statsbind555[c(1,2,4)], statsbindScale)
statscbindScale$NegTOV <- statscbindScale$TOV * -1
statscbindScale$NegPF <- statscbindScale$PF * -1
##Creating the all-in-one value
statscbindScale[,31] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,28,29,30)])
statscbindScale$combined_Z <- statscbindScale[,31]/12
statscombined_Z <- subset(statscbindScale, combined_Z < -1.3 | combined_Z > 1.08)
statscbindScale$abovebelow_Z <- ifelse(statscbindScale$combined_Z < 0, "below", "above")
ggplot(statscombined_Z, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab("Player")
statscombined_Z$abovebelow_Z <- ifelse(statscombined_Z$combined_Z < 0, "below", "above")
ggplot(statscombined_Z, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab("Player")
statscombined_Zgames <- subset(statscbindScale, G > -1.095 & (combined_Z < -.5262 | combined_Z > 1.08))
statscombined_Zgames$abovebelow_Z <- ifelse(statscombined_Zgames$combined_Z < 0, "below", "above")
ggplot(subset(statscombined_Zgames), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season", subtitle = "Players with over 20 games played") + coord_flip() + xlab("Player")
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#C49A00", "SG"="#00C094", "SF"="#00B6EB", "PF"="#53B400","C"="#F8766D")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#C49A00", "SG"="#00C094", "SF"="#FB61D7", "PF"="#53B400","C"="#F8766D")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#C49A00", "SG"="#00B6EB", "SF"="#FB61D7", "PF"="#53B400","C"="#F8766D")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
ggplot(statscombined_Z, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab("Player")
ggplot(statscombined_Z, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Normalized Production", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab("Player")
ggplot(subset(statscombined_Zgames), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season", subtitle = "Players with over 20 games played") + coord_flip() + xlab("Player")
ggplot(statscombined_Zgames, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season", subtitle = "Players with over 20 games played") + coord_flip() + xlab("Player")
ggplot(statscombined_Zgames, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Normalized Production", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season", subtitle = "Players with over 20 games played") + coord_flip() + xlab("Player")
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#FF0000", "SG"="#FF6400", "SF"="#FFFF00", "PF"="#008000","C"="#0000FF")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#C49A00", "SG"="#00B6EB", "SF"="#FB61D7", "PF"="#53B400","C"="#F8766D")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
View(statsbind555)
positionaggregate <- aggregate(statsbind555$3P, by=list(Position = statsbind555$Pos), FUN = sum)
positionaggregate <- aggregate(statsbind555$3P, by=list(Position = statsbind555$Pos), FUN = sum)
positionaggregate <- aggregate(statsbind555$FG, by=list(Position = statsbind555$Pos), FUN = sum)
positionaggregate <- aggregate(statsbind555$FG, by=list(Pos = statsbind555$Pos), FUN = sum)
str(statsbind555)
str(stats18numeric)
statscbindnew <- cbind(statsbind555[c(1,2,4)], statsbindScale)
View(statscbindnew)
statscbindNoScale <- cbind(statsbind555[c(1,2,4)], statsbind2)
View(statscbindNoScale)
tapply(statscbindNoScale$FG, statscbindNoScale$Pos, FUN = sum)
postitiontotals <- tapply(statscbindNoScale$FG, statscbindNoScale$Pos, FUN = sum)
as.data.frame(positiontotals)
positiontotals <- tapply(statscbindNoScale$FG, statscbindNoScale$Pos, FUN = sum)
as.data.frame(positiontotals)
positiontotalsframe <- as.data.frame(positiontotals)
View(positiontotalsframe)
View(statscbindNoScale)
positiontotals <- tapply(statscbindNoScale[,8:9], statscbindNoScale$Pos, FUN = sum)
aggregate(statscbindNoScale$FG, by=list(Pos = statscbindNoScale$Pos))
aggregate(statscbindNoScale$FG, by=list(Pos = statscbindNoScale$Pos), FUN = sum())
aggregate(statscbindNoScale$FG, by=list(Pos = statscbindNoScale$Pos), FUN = sum
)
aggregate(statscbindNoScale$FG, by=list(Pos = statscbindNoScale$Pos), FUN = sum)
aggregate(. ~ Pos, statscbindNoScale[,8:9], sum)
aggregate(. ~ statscbindNoScale$Pos, statscbindNoScale[,8:9], sum)
aggregate(. ~ statscbindNoScale$Pos, statscbindNoScale[,10,13,16,17,20,21,23,24,25,28,29,30], sum)
aggregate(. ~ statscbindNoScale$Pos, statscbindNoScale[c(10,13,16,17,20,21,23,24,25,28,29,30)], sum)
aggregate(. ~ statscbindNoScale$Pos, statscbindNoScale[c(10,13,16,17,20,21,23,24,25,28,29)], sum)
positionaggregates <- aggregate(. ~ statscbindNoScale$Pos, statscbindNoScale[c(10,13,16,17,20,21,23,24,25,28,29)], sum)
View(positionaggregates)
positionaggregates5 <- subset(positionaggregates, FGpct > 1)
View(positionaggregates5)
View(statscbindNoScale)
View(positionaggregates5)
View(positionaggregates)
View(statscbindScale)
setwd("D:/RLearning/All-in-one")
install.packages("XML")
install.packages("RCurl")
install.packages("plyr")
install.packages("ggplot2")
library(XML)
library(RCurl)
library(plyr)
library(ggplot2)
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
# These produce the same results: url <- "https://stats.nba.com/leaders/"
urldata <-  getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
#This one does not work dat3 <- as.data.frame(data, col.names = names(data), headers = TRUE)
#This one works - But all variables are characteristic
stats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(stats18)[12] <- "FGpct"
colnames(stats18)[13] <- "3P"
colnames(stats18)[14] <- "3PA"
colnames(stats18)[15] <- "3Ppct"
colnames(stats18)[16] <- "2P"
colnames(stats18)[17] <- "2PA"
colnames(stats18)[18] <- "2Ppct"
colnames(stats18)[19] <- "eFG"
colnames(stats18)[22] <- "FTpct"
#Removing irrelevant variables, NAs, and converting to numeric
stats18$.id <- NULL
stats18$Rk <- NULL
stats18numeric <- as.data.frame(sapply(stats18[c(3,5:29)], as.numeric))
stats18numeric[is.na(stats18numeric)] <- 0
View(stats18numeric)
str(stats18numeric)
TOTplayer <- subset(stats18, Tm == "TOT")
View(TOTplayer)
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
View(statsTraded)
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"), encoding = "utf-8")
View(statsTraded)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE, encoding = "utf-8")
stats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(stats18)[12] <- "FGpct"
colnames(stats18)[13] <- "3P"
colnames(stats18)[14] <- "3PA"
colnames(stats18)[15] <- "3Ppct"
colnames(stats18)[16] <- "2P"
colnames(stats18)[17] <- "2PA"
colnames(stats18)[18] <- "2Ppct"
colnames(stats18)[19] <- "eFG"
colnames(stats18)[22] <- "FTpct"
#Removing irrelevant variables, NAs, and converting to numeric
stats18$.id <- NULL
stats18$Rk <- NULL
##Numeric needs to ignore the character variables
stats18numeric <- as.data.frame(sapply(stats18[c(3,5:29)], as.numeric))
stats18numeric[is.na(stats18numeric)] <- 0
TOTplayer <- subset(stats18, Tm == "TOT")
#Cleaning traded duplicates and adding in traded players totals
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"), encoding = "utf-8")
View(statsTraded)
TOTplayer <- subset(stats18, Tm == "TOT", encoding = "utf-8")
View(TOTplayer)
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"), encoding = "utf-8")
View(TOTplayer)
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"), encoding = "UTF-8")
data <- readHTMLTable(urldata, stringsAsFactors = FALSE, encoding = "UTF-8")
stats18 <- ldply(data, data.frame, encoding = "UTF-8")
# Adjusting variable names
colnames(stats18)[12] <- "FGpct"
colnames(stats18)[13] <- "3P"
colnames(stats18)[14] <- "3PA"
colnames(stats18)[15] <- "3Ppct"
colnames(stats18)[16] <- "2P"
colnames(stats18)[17] <- "2PA"
colnames(stats18)[18] <- "2Ppct"
colnames(stats18)[19] <- "eFG"
colnames(stats18)[22] <- "FTpct"
#Removing irrelevant variables, NAs, and converting to numeric
stats18$.id <- NULL
stats18$Rk <- NULL
##Numeric needs to ignore the character variables
stats18numeric <- as.data.frame(sapply(stats18[c(3,5:29)], as.numeric))
stats18numeric[is.na(stats18numeric)] <- 0
TOTplayer <- subset(stats18, Tm == "TOT", encoding = "UTF-8")
View(TOTplayer)
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"), encoding = "UTF-8")
View(statsTraded)
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
TOTplayer <- subset(stats18, Tm == "TOT")
stats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(stats18)[12] <- "FGpct"
colnames(stats18)[13] <- "3P"
colnames(stats18)[14] <- "3PA"
colnames(stats18)[15] <- "3Ppct"
colnames(stats18)[16] <- "2P"
colnames(stats18)[17] <- "2PA"
colnames(stats18)[18] <- "2Ppct"
colnames(stats18)[19] <- "eFG"
colnames(stats18)[22] <- "FTpct"
#Removing irrelevant variables, NAs, and converting to numeric
stats18$.id <- NULL
stats18$Rk <- NULL
##Numeric needs to ignore the character variables
stats18numeric <- as.data.frame(sapply(stats18[c(3,5:29)], as.numeric))
stats18numeric[is.na(stats18numeric)] <- 0
View(stats18)
View(statsTraded)
View(TOTplayer)
TOTplayer$Player <- revalue(TOTplayer$Player, c("Boban Marjanovi훶"="Boban"))
data <- readHTMLTable(urldata, stringsAsFactors = FALSE, encoding = "UTF-8")
stats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(stats18)[12] <- "FGpct"
colnames(stats18)[13] <- "3P"
colnames(stats18)[14] <- "3PA"
colnames(stats18)[15] <- "3Ppct"
colnames(stats18)[16] <- "2P"
colnames(stats18)[17] <- "2PA"
colnames(stats18)[18] <- "2Ppct"
colnames(stats18)[19] <- "eFG"
colnames(stats18)[22] <- "FTpct"
stats18$.id <- NULL
stats18$Rk <- NULL
stats18numeric <- as.data.frame(sapply(stats18[c(3,5:29)], as.numeric))
stats18numeric[is.na(stats18numeric)] <- 0
TOTplayer <- subset(stats18, Tm == "TOT")
View(TOTplayer)
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
"%ni%" <- Negate("%in%")
statsnotTraded <- subset(stats18, Player %ni% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
statsbind <- rbind(statsnotTraded, TOTplayer)
#Eliminating the extraneous "player" headers from the HTML Table
statsbind2 <- subset(statsbind, Player %ni% c("Player"))
statsbind555 <- subset(statsbind, Player %ni% c("Player"))
#Calculating Z Scores
statsbind2 <- as.data.frame(sapply(statsbind2[c(3,5:29)], as.numeric))
statsbind2[is.na(statsbind2)] <- 0
statsbind2$PTSZ <- (statsbind2$PTS - mean(statsbind2$PTS))/sd(statsbind2$PTS)
statsbindScale <- scale(statsbind2[,1:27])
##Problem here is that they need identical rows so the orignal needs to be subset
##
statscbindScale <- cbind(statsbind555[c(1,2,4)], statsbindScale)
statscbindScale$NegTOV <- statscbindScale$TOV * -1
statscbindScale$NegPF <- statscbindScale$PF * -1
##Creating the all-in-one value
statscbindScale[,31] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,28,29,30)])
statscbindScale$combined_Z <- statscbindScale[,31]/12
##Diverging Bar Visualization
statscombined_Z <- subset(statscbindScale, combined_Z < -1.3 | combined_Z > 1.08)
statscbindScale$abovebelow_Z <- ifelse(statscbindScale$combined_Z < 0, "below", "above")
statscombined_Z$abovebelow_Z <- ifelse(statscombined_Z$combined_Z < 0, "below", "above")
ggplot(statscombined_Z, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab("Player")
##Players with over 20 games played
statscombined_Zgames <- subset(statscbindScale, G > -1.095 & (combined_Z < -.5262 | combined_Z > 1.08))
statscombined_Zgames$abovebelow_Z <- ifelse(statscombined_Zgames$combined_Z < 0, "below", "above")
ggplot(statscombined_Zgames, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season", subtitle = "Players with over 20 games played") + coord_flip() + xlab("Player")
#Top 25 Players by Normalized Position
ggplot(subset(statscbindScale, combined_Z > 1.02), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=Pos), width=.5) + scale_fill_manual(name="Position", labels=c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard"), values=c("PG"="#C49A00", "SG"="#00B6EB", "SF"="#FB61D7", "PF"="#53B400","C"="#F8766D")) +labs(title ="Top 25 Players by Normalized Production") + coord_flip() + xlab('Player') + ylab('Combined Z Score')
#Pie Chart and Frequency table
freqtable <- c(10/25,3/25,5/25,4/25,3/25)
freqmatrix <- matrix(freqtable, ncol=5, byrow = TRUE)
freqmatrix <- t(freqmatrix)
freqframe[,2] <- c("Center", "Power Forward", "Point Guard", "Small Forward", "Shooting Guard")
names(freqframe)[1] <- "Prob"
names(freqframe)[2] <- "PlayerPosition"
ggplot(freqframe, aes(x="", y= Prob, fill = factor(PlayerPosition))) + geom_bar(width = 1, stat = "identity") + theme(axis.line = element_blank(), plot.title = element_text(hjust = 0.5), axis.text.x = element_blank()) + labs(fill = "Position", x = NULL, y = NULL, title = "Proportion of Positions in the Top 25 Players") + coord_polar(theta = "y", start = 0) + geom_text(aes(label=Prob), position = position_stack(vjust = 0.5))
##Position totals AKA visualizing why centers are overrepresented
statscbindNoScale <- cbind(statsbind555[c(1,2,4)], statsbind2)
positiontotals <- tapply(statscbindNoScale$FG, statscbindNoScale$Pos, FUN = sum)
positionaggregates <- aggregate(. ~ statscbindNoScale$Pos, statscbindNoScale[c(10,13,16,17,20,21,23,24,25,28,29)], sum)
positionaggregates5 <- subset(positionaggregates, FGpct > 1)
setwd("D:/RLearning/All-in-one")
install.packages("XML")
install.packages("RCurl")
install.packages("plyr")
install.packages("ggplot2")
library(XML)
library(RCurl)
library(plyr)
library(ggplot2)
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
# These produce the same results: url <- "https://stats.nba.com/leaders/"
urldata <-  getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE, encoding = "UTF-8")
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
#This one does not work dat3 <- as.data.frame(data, col.names = names(data), headers = TRUE)
#This one works - But all variables are characteristic
stats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(stats18)[12] <- "FGpct"
colnames(stats18)[13] <- "3P"
colnames(stats18)[14] <- "3PA"
colnames(stats18)[15] <- "3Ppct"
colnames(stats18)[16] <- "2P"
colnames(stats18)[17] <- "2PA"
colnames(stats18)[18] <- "2Ppct"
colnames(stats18)[19] <- "eFG"
colnames(stats18)[22] <- "FTpct"
#Removing irrelevant variables, NAs, and converting to numeric
stats18$.id <- NULL
stats18$Rk <- NULL
##Numeric needs to ignore the character variables
stats18numeric <- as.data.frame(sapply(stats18[c(3,5:29)], as.numeric))
stats18numeric[is.na(stats18numeric)] <- 0
#Isolating all traded players that show up as double in the data set
TOTplayer <- subset(stats18, Tm == "TOT")
#Cleaning traded duplicates and adding in traded players totals
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
"%ni%" <- Negate("%in%")
statsnotTraded <- subset(stats18, Player %ni% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
View(statsnotTraded)
View(statsnotTraded)
statsbindcharacters <- subset(statsbind, Player %ni% c("Player"))
statsbind2 <- subset(statsbind, Player %ni% c("Player"))
statsnotTraded <- subset(stats18, Player %ni% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valan훾i큰nas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
statsbind <- rbind(statsnotTraded, TOTplayer)
statsbind2 <- subset(statsbind, Player %ni% c("Player"))
statsbindcharacters <- subset(statsbind, Player %ni% c("Player"))
statsbind2 <- as.data.frame(sapply(statsbind2[c(3,5:29)], as.numeric))
statsbind2[is.na(statsbind2)] <- 0
statsbind2$PTSZ <- (statsbind2$PTS - mean(statsbind2$PTS))/sd(statsbind2$PTS)
statsbindScale <- scale(statsbind2[,1:27])
statscbindScale <- cbind(statsbindcharacters[c(1,2,4)], statsbindScale)
statscbindScale$NegTOV <- statscbindScale$TOV * -1
statscbindScale$NegPF <- statscbindScale$PF * -1
View(statscbindScale)
View(statscbindScale)
statscbindScale[,33] <- rowSums(statscbindScale[c(8,11,14,17,18,23,24,25,26,29,31,32)])
statscbindScale$combined_Z <- statscbindScale[,33]/12
View(statscbindScale)
statscombined_Z <- subset(statscbindScale, combined_Z < -0.7099 | combined_Z > 1.06)
statscbindScale$abovebelow_Z <- ifelse(statscbindScale$combined_Z < 0, "below", "above")
statscombined_Z$abovebelow_Z <- ifelse(statscombined_Z$combined_Z < 0, "below", "above")
ggplot(statscombined_Z, aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip() + xlab("Player")
